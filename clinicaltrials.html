<!-- File: /public/eligibility-screening-min.html
Title: Prostate Trial Eligibility Screener (only requested questions)
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eligibility Screener</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#f7fafc; --card:#ffffff; --text:#1f2937; --muted:#6b7280; --accent:#0f6fa1; --accent-2:#0b5b84; --border:#d1d5db; --good:#0f766e; --bad:#b91c1c; --focus:#1d4ed8; --shadow:0 8px 24px rgba(0,0,0,.08); }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .container{max-width:780px;margin-inline:auto;padding:16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:16px}
    h1{margin:0 0 6px;font-size:24px}
    .sub{color:var(--muted);margin:0 0 12px}

    /* grid */
    .grid{display:grid;grid-template-columns:1fr;gap:12px}

    /* field */
    .field{display:grid;gap:6px}
    .label{font-weight:700}
    .help{color:var(--muted);font-size:12px}

    /* inputs */
    input[type="number"], select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:9px;font-size:15px;background:#fff}
    input[type="number"]:focus, select:focus{outline:3px solid var(--focus);outline-offset:1px}

    /* segmented radios (uniform width) */
    .seg{display:grid;grid-template-columns:1fr 1fr;align-items:stretch;border:1px solid #cdd6df;border-radius:999px;overflow:hidden}
    .seg input{position:absolute;opacity:0;pointer-events:none}
    .seg label{padding:10px 16px;cursor:pointer;font-weight:700;text-align:center;font-size:15px;user-select:none}
    .seg label[data-checked="true"]{background:var(--accent);color:#fff}
    .seg label[data-side="right"]{border-left:1px solid #cdd6df}

    /* actions */
    .actions{display:flex;gap:10px;align-items:center}
    .btn{background:linear-gradient(180deg,var(--accent),var(--accent-2));color:#fff;border:0;border-radius:999px;padding:10px 16px;font-weight:800;cursor:pointer}
    .btn.secondary{background:#fff;color:var(--accent-2);border:1px solid #cbd5e1}

    /* result */
    .result{margin-top:12px;border-radius:12px;border:1px solid var(--border);padding:12px;background:#fff}
    .badge{display:inline-block;border-radius:999px;padding:6px 10px;font-weight:800}
    .badge.good{background:#ecfdf5;color:var(--good);border:1px solid #99f6e4}
    .badge.bad{background:#fef2f2;color:var(--bad);border:1px solid #fecaca}
    .reason-list{margin:10px 0 0;padding-left:18px}
  </style>
</head>
<body>
  <main class="container">
    <div class="card">
      <h1>Is this patient eligible for screening?</h1>
      <p class="sub">Only the questions you requested are shown.</p>

      <form id="form" class="grid" novalidate>
        <!-- Age -->
        <div class="field">
          <label class="label" for="age">Age</label>
          <input id="age" name="age" type="number" inputmode="numeric" min="0" step="1" placeholder="e.g., 63" required>
          <p class="help">Inclusion: adult male ≥ 18 years old.</p>
        </div>

        <!-- Pre-treatment MRI? -->
        <div class="field">
          <span class="label">Pre‑treatment MRI completed?</span>
          <div class="seg" role="radiogroup" aria-label="Pre-treatment MRI">
            <input type="radio" name="premri" id="premriYes" value="yes" required>
            <label for="premriYes" data-side="left">Yes</label>
            <input type="radio" name="premri" id="premriNo" value="no">
            <label for="premriNo" data-side="right">No</label>
          </div>
        </div>

        <!-- SOC focal therapy received -->
        <div class="field">
          <label class="label" for="therapy">SOC focal therapy received</label>
          <select id="therapy" name="therapy" required>
            <option value="">Select type…</option>
            <option value="focal">Focal ablation</option>
            <option value="hemi">Hemiablation</option>
            <option value="whole">Whole gland ablation</option>
            <option value="none">None / Other</option>
          </select>
        </div>

        <!-- Months since therapy -->
        <div class="field">
          <label class="label" for="months">Months since therapy</label>
          <input id="months" name="months" type="number" min="0" step="1" placeholder="e.g., 5" required>
        </div>

        <!-- Standard template biopsy before treatment? -->
        <div class="field">
          <span class="label">Standard template biopsy before treatment?</span>
          <div class="seg" role="radiogroup" aria-label="Standard template biopsy before treatment">
            <input type="radio" name="biopsy" id="biopsyYes" value="yes" required>
            <label for="biopsyYes" data-side="left">Yes</label>
            <input type="radio" name="biopsy" id="biopsyNo" value="no">
            <label for="biopsyNo" data-side="right">No</label>
          </div>
        </div>

        <!-- Sex -->
        <div class="field">
          <span class="label">Sex</span>
          <div class="seg" role="radiogroup" aria-label="Sex">
            <input type="radio" name="sex" id="sexMale" value="male" required>
            <label for="sexMale" data-side="left">Male</label>
            <input type="radio" name="sex" id="sexFemale" value="female">
            <label for="sexFemale" data-side="right">Female</label>
          </div>
        </div>

        <div class="actions" style="grid-column:1/-1;margin-top:4px">
          <button type="submit" class="btn">Evaluate Eligibility</button>
          <button type="reset" class="btn secondary" id="resetBtn">Reset</button>
        </div>
      </form>

      <section id="result" class="result" aria-live="polite" aria-atomic="true">
        <span class="badge" id="status">—</span>
        <ul class="reason-list" id="reasons"></ul>
      </section>
    </div>
  </main>

  <script>
    const qs = (s, el=document) => el.querySelector(s);
    const qsa = (s, el=document) => Array.from(el.querySelectorAll(s));

    function refreshSegments(){
      qsa('.seg').forEach(seg => {
        const group = seg.querySelectorAll('input[type="radio"][name]');
        group.forEach(input => {
          const label = seg.querySelector('label[for="'+input.id+'"]');
          if(label){ label.dataset.checked = String(input.checked); }
        });
      });
    }

    function evalEligibility(){
      const reasons = [], exclusions = [];
      const age = Number(qs('#age').value);
      const premri = qs('input[name="premri"]:checked');
      const therapy = qs('#therapy').value;
      const months = Number(qs('#months').value);
      const biopsy = qs('input[name="biopsy"]:checked');
      const sex = qs('input[name="sex"]:checked');

      const missing = [];
      [[qs('#age').value,'Age'],[premri,'Pre-treatment MRI'],[therapy,'Therapy type'],[qs('#months').value,'Months since therapy'],[biopsy,'Biopsy'],[sex,'Sex']].forEach(([v,label])=>{ if(v===null||v===undefined||v===''||Number.isNaN(v)) missing.push(label); });
      if(missing.length){ setStatus('Please complete: '+missing.join(', ')+'.'); return; }

      if(!(sex && sex.value==='male')) reasons.push('Inclusion requires males only.');
      if(age < 18) reasons.push('Age must be ≥ 18.');
      if(premri.value !== 'yes') reasons.push('Pre-treatment MRI is required.');
      if(biopsy.value !== 'yes') reasons.push('Standard template biopsy before treatment is required.');

      if(therapy === 'focal' || therapy === 'hemi'){
        if(!Number.isFinite(months) || months > 9) exclusions.push('Partial gland ablation occurred > 9 months ago.');
      } else if(therapy === 'whole'){
        exclusions.push('Previously treated with whole gland ablation.');
      } else {
        reasons.push('Requires SOC focal or hemiablation.');
      }

      const allIssues = exclusions.concat(reasons);
      const eligible = allIssues.length === 0;
      const statusEl = qs('#status');
      statusEl.textContent = eligible ? 'Eligible' : 'Not Eligible';
      statusEl.className = 'badge ' + (eligible ? 'good' : 'bad');
      const ul = qs('#reasons');
      ul.innerHTML = '';
      if(!eligible){ allIssues.forEach(txt => { const li = document.createElement('li'); li.textContent = txt; ul.appendChild(li); }); }
    }

    function setStatus(text){ const s = qs('#status'); s.textContent = text; s.className = 'badge'; qs('#reasons').innerHTML = ''; }

    function init(){ refreshSegments(); qsa('input, select').forEach(el=>{ el.addEventListener('change', ()=>{ refreshSegments(); evalEligibility(); }); if(el.type==='number'){ el.addEventListener('input', ()=> evalEligibility()); } }); }

    init();
    qs('#form').addEventListener('submit', (e)=>{ e.preventDefault(); evalEligibility(); });
    qs('#resetBtn').addEventListener('click', ()=>{ setTimeout(()=>{ refreshSegments(); setStatus('—'); }, 0); });
  </script>
</body>
</html>
